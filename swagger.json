{
  "openapi": "3.0.0",
  "info": {
    "title": "AvironApp API",
    "version": "1.0.0"
  },
  "paths": {
    "/auth/register": {
      "post": {
        "tags": [
          "auth"
        ],
        "summary": "Création d’un compte utilisateur",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string"
                  },
                  "email": {
                    "type": "string"
                  },
                  "num_license": {
                    "type": "string",
                    "description": "Numéro de licence (optionnel)"
                  },
                  "password": {
                    "type": "string"
                  }
                },
                "required": [
                  "name",
                  "email",
                  "password"
                ]
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Utilisateur créé"
          },
          "400": {
            "description": "Email déjà utilisé"
          }
        }
      }
    },
    "/auth/login": {
      "post": {
        "tags": [
          "auth"
        ],
        "summary": "Connexion utilisateur (email ou numéro de licence)",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "identifier": {
                    "type": "string",
                    "description": "Email ou numéro de licence"
                  },
                  "password": {
                    "type": "string"
                  }
                },
                "required": [
                  "identifier",
                  "password"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Tokens retournés"
          },
          "401": {
            "description": "Identifiants invalides"
          }
        }
      }
    },
    "/auth/refresh-token": {
      "post": {
        "tags": [
          "auth"
        ],
        "summary": "Renouvellement du jeton JWT",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "refresh_token": {
                    "type": "string"
                  }
                },
                "required": [
                  "refresh_token"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Jeton JWT renouvelé"
          },
          "401": {
            "description": "Jeton de rafraîchissement invalide"
          }
        }
      }
    },
    "/auth/logout": {
      "post": {
        "tags": [
          "auth"
        ],
        "summary": "Déconnexion de l’utilisateur",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "refresh_token": {
                    "type": "string"
                  }
                },
                "required": [
                  "refresh_token"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Déconnexion réussie"
          },
          "400": {
            "description": "Jeton introuvable"
          }
        }
      }
    },
    "/auth/me": {
      "get": {
        "tags": [
          "auth"
        ],
        "summary": "Informations du profil connecté",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Détails de l'utilisateur connecté"
          },
          "401": {
            "description": "Accès non autorisé"
          }
        }
      }
    },
    "/auth/verify-email": {
      "get": {
        "tags": [
          "auth"
        ],
        "summary": "Vérification de l’adresse email",
        "parameters": [
          {
            "name": "token",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Email vérifié avec succès"
          },
          "400": {
            "description": "Token invalide"
          }
        }
      }
    },
    "/auth/request-password-reset": {
      "post": {
        "tags": [
          "auth"
        ],
        "summary": "Demande de réinitialisation de mot de passe",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "identifier": {
                    "type": "string"
                  }
                },
                "required": [
                  "identifier"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Email envoyé"
          },
          "404": {
            "description": "Utilisateur non trouvé"
          }
        }
      }
    },
    "/auth/reset-password": {
      "post": {
        "tags": [
          "auth"
        ],
        "summary": "Réinitialisation du mot de passe",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "token": {
                    "type": "string"
                  },
                  "new_password": {
                    "type": "string"
                  }
                },
                "required": [
                  "token",
                  "new_password"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Mot de passe mis à jour"
          },
          "400": {
            "description": "Token invalide ou expiré"
          }
        }
      }
    },
    "/auth/sessions": {
      "get": {
        "tags": [
          "auth"
        ],
        "summary": "Lister les sessions actives de l'utilisateur",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Liste des sessions",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "user_agent": {
                            "type": "string"
                          },
                          "ip_address": {
                            "type": "string"
                          },
                          "is_active": {
                            "type": "boolean"
                          },
                          "expires_at": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "created_at": {
                            "type": "string",
                            "format": "date-time"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Non autorisé"
          }
        }
      }
    },
    "/auth/change-password": {
      "post": {
        "tags": [
          "auth"
        ],
        "summary": "Modifier le mot de passe (utilisateur connecté)",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "currentPassword": {
                    "type": "string"
                  },
                  "newPassword": {
                    "type": "string"
                  }
                },
                "required": [
                  "currentPassword",
                  "newPassword"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Mot de passe mis à jour"
          },
          "400": {
            "description": "Mot de passe actuel incorrect"
          },
          "401": {
            "description": "Non autorisé"
          }
        }
      }
    },
    "/auth/sessions/{id}": {
      "delete": {
        "tags": [
          "auth"
        ],
        "summary": "Déconnecter un appareil (invalider une session)",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID de la session à invalider"
          }
        ],
        "responses": {
          "200": {
            "description": "Session déconnectée",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "message": {
                      "type": "string",
                      "example": "Session déconnectée"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Session non trouvée ou déjà inactive",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string"
                    },
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/events": {
      "get": {
        "tags": [
          "Events"
        ],
        "summary": "Liste des événements",
        "responses": {
          "200": {
            "description": "Liste des événements renvoyée"
          }
        }
      },
      "post": {
        "tags": [
          "Events"
        ],
        "summary": "Créer un événement",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "name",
                  "location",
                  "start_date",
                  "end_date"
                ],
                "properties": {
                  "name": {
                    "type": "string"
                  },
                  "location": {
                    "type": "string"
                  },
                  "start_date": {
                    "type": "string",
                    "format": "date-time"
                  },
                  "end_date": {
                    "type": "string",
                    "format": "date-time"
                  },
                  "race_type": {
                    "type": "string"
                  },
                  "website_url": {
                    "type": "string",
                    "format": "uri"
                  },
                  "image_url": {
                    "type": "string",
                    "format": "uri"
                  },
                  "organiser_name": {
                    "type": "string"
                  },
                  "organiser_code": {
                    "type": "string"
                  },
                  "is_visible": {
                    "type": "boolean"
                  },
                  "is_finished": {
                    "type": "boolean"
                  },
                  "progression_template_id": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Événement créé"
          },
          "400": {
            "description": "Données invalides"
          }
        }
      }
    },
    "/events/{id}": {
      "get": {
        "tags": [
          "Events"
        ],
        "summary": "Obtenir un événement par ID",
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Détail de l’événement"
          },
          "404": {
            "description": "Événement non trouvé"
          }
        }
      },
      "put": {
        "tags": [
          "Events"
        ],
        "summary": "Modifier un événement",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string"
                  },
                  "location": {
                    "type": "string"
                  },
                  "start_date": {
                    "type": "string",
                    "format": "date-time"
                  },
                  "end_date": {
                    "type": "string",
                    "format": "date-time"
                  },
                  "race_type": {
                    "type": "string"
                  },
                  "website_url": {
                    "type": "string",
                    "format": "uri"
                  },
                  "image_url": {
                    "type": "string",
                    "format": "uri"
                  },
                  "organiser_name": {
                    "type": "string"
                  },
                  "organiser_code": {
                    "type": "string"
                  },
                  "is_visible": {
                    "type": "boolean"
                  },
                  "is_finished": {
                    "type": "boolean"
                  },
                  "progression_template_id": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Événement mis à jour"
          },
          "400": {
            "description": "Données invalides"
          },
          "404": {
            "description": "Événement non trouvé"
          }
        }
      },
      "delete": {
        "tags": [
          "Events"
        ],
        "summary": "Supprimer un événement",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Événement supprimé"
          },
          "404": {
            "description": "Événement non trouvé"
          }
        }
      }
    },
    "/participants": {
      "get": {
        "tags": [
          "participants"
        ],
        "summary": "Liste des participants",
        "responses": {
          "200": {
            "description": "Liste renvoyée"
          }
        }
      },
      "post": {
        "tags": [
          "participants"
        ],
        "summary": "Créer un participant",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "first_name",
                  "last_name",
                  "license_number",
                  "gender"
                ],
                "properties": {
                  "first_name": {
                    "type": "string"
                  },
                  "last_name": {
                    "type": "string"
                  },
                  "license_number": {
                    "type": "string"
                  },
                  "gender": {
                    "type": "string",
                    "enum": [
                      "Homme",
                      "Femme"
                    ]
                  },
                  "email": {
                    "type": "string",
                    "format": "email"
                  },
                  "club_name": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Participant créé"
          }
        }
      }
    },
    "/participants/event/{event_id}": {
      "get": {
        "tags": [
          "participants"
        ],
        "summary": "Liste des participants d’un événement",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "event_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "ID de l’événement"
          }
        ],
        "responses": {
          "200": {
            "description": "Liste des participants de l’événement",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/Participant"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/participants/{id}": {
      "get": {
        "tags": [
          "participants"
        ],
        "summary": "Obtenir un participant par ID",
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Détail du participant"
          },
          "404": {
            "description": "Participant non trouvé"
          }
        }
      },
      "put": {
        "tags": [
          "participants"
        ],
        "summary": "Modifier un participant",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "first_name": {
                    "type": "string"
                  },
                  "last_name": {
                    "type": "string"
                  },
                  "license_number": {
                    "type": "string"
                  },
                  "gender": {
                    "type": "string",
                    "enum": [
                      "Homme",
                      "Femme"
                    ]
                  },
                  "email": {
                    "type": "string",
                    "format": "email"
                  },
                  "club_name": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Participant mis à jour"
          }
        }
      },
      "delete": {
        "tags": [
          "participants"
        ],
        "summary": "Supprimer un participant",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Participant supprimé"
          }
        }
      }
    },
    "/categories": {
      "get": {
        "tags": [
          "categories"
        ],
        "summary": "Liste des catégories",
        "responses": {
          "200": {
            "description": "Liste renvoyée"
          }
        }
      },
      "post": {
        "tags": [
          "categories"
        ],
        "summary": "Créer une catégorie",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "label"
                ],
                "properties": {
                  "code": {
                    "type": "string"
                  },
                  "label": {
                    "type": "string"
                  },
                  "age_group": {
                    "type": "string"
                  },
                  "gender": {
                    "type": "string",
                    "enum": [
                      "Homme",
                      "Femme",
                      "Mixte"
                    ]
                  },
                  "boat_seats": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 8
                  },
                  "has_coxswain": {
                    "type": "boolean"
                  },
                  "distance_id": {
                    "type": "string",
                    "nullable": true,
                    "description": "ID de la distance associée (peut être null)"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Catégorie créée"
          }
        }
      }
    },
    "/categories/event/{event_id}/with-crews": {
      "get": {
        "tags": [
          "categories"
        ],
        "summary": "Liste des catégories d’un événement avec équipages",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "event_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID de l’événement"
          }
        ],
        "responses": {
          "200": {
            "description": "Liste des catégories et équipages",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "code": {
                            "type": "string"
                          },
                          "label": {
                            "type": "string"
                          },
                          "age_group": {
                            "type": "string"
                          },
                          "gender": {
                            "type": "string"
                          },
                          "boat_seats": {
                            "type": "integer"
                          },
                          "has_coxswain": {
                            "type": "boolean"
                          },
                          "crew_count": {
                            "type": "integer"
                          },
                          "crews": {
                            "type": "array",
                            "items": {
                              "$ref": "#/components/schemas/Crew"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/categories/{id}": {
      "get": {
        "tags": [
          "categories"
        ],
        "summary": "Obtenir une catégorie par ID",
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Détail de la catégorie"
          },
          "404": {
            "description": "Non trouvée"
          }
        }
      },
      "put": {
        "tags": [
          "categories"
        ],
        "summary": "Modifier une catégorie",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "code": {
                    "type": "string"
                  },
                  "label": {
                    "type": "string"
                  },
                  "age_group": {
                    "type": "string"
                  },
                  "gender": {
                    "type": "string",
                    "enum": [
                      "Homme",
                      "Femme",
                      "Mixte"
                    ]
                  },
                  "boat_seats": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 8
                  },
                  "has_coxswain": {
                    "type": "boolean"
                  },
                  "distance_id": {
                    "type": "string",
                    "nullable": true,
                    "description": "ID de la distance associée (peut être null)"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Mise à jour réussie"
          }
        }
      },
      "delete": {
        "tags": [
          "categories"
        ],
        "summary": "Supprimer une catégorie",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Supprimée avec succès"
          }
        }
      }
    },
    "/event-categories": {
      "post": {
        "tags": [
          "eventcategories"
        ],
        "summary": "Lier une catégorie à un événement",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "event_id",
                  "category_id"
                ],
                "properties": {
                  "event_id": {
                    "type": "string"
                  },
                  "category_id": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Liaison créée"
          },
          "400": {
            "description": "Déjà lié"
          }
        }
      }
    },
    "/event-categories/{event_id}": {
      "get": {
        "tags": [
          "eventcategories"
        ],
        "summary": "Récupérer les catégories liées à un événement",
        "parameters": [
          {
            "in": "path",
            "name": "event_id",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Liste des catégories liées"
          }
        }
      }
    },
    "/event-categories/unlink/{id}": {
      "delete": {
        "tags": [
          "eventcategories"
        ],
        "summary": "Supprimer une liaison événement ↔ catégorie",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Lien supprimé"
          }
        }
      }
    },
    "/crews": {
      "get": {
        "tags": [
          "crews"
        ],
        "summary": "Liste des équipages",
        "responses": {
          "200": {
            "description": "Liste des équipages"
          }
        }
      },
      "post": {
        "tags": [
          "crews"
        ],
        "summary": "Créer un équipage",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "event_id",
                  "category_id"
                ],
                "properties": {
                  "event_id": {
                    "type": "string"
                  },
                  "category_id": {
                    "type": "string"
                  },
                  "status": {
                    "type": "string",
                    "enum": [
                      "registered",
                      "dns",
                      "dnf",
                      "disqualified",
                      "changed",
                      "withdrawn",
                      "scratch"
                    ],
                    "default": "registered",
                    "description": "Statut de l'équipage"
                  },
                  "club_name": {
                    "type": "string"
                  },
                  "club_code": {
                    "type": "string"
                  },
                  "coach_name": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Équipage créé"
          }
        }
      }
    },
    "/crews/event/{event_id}": {
      "get": {
        "tags": [
          "crews"
        ],
        "summary": "Liste des équipages d’un événement",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "event_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "ID de l’événement"
          }
        ],
        "responses": {
          "200": {
            "description": "Liste des équipages pour l’événement donné",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/Crew"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/crews/{id}": {
      "get": {
        "tags": [
          "crews"
        ],
        "summary": "Obtenir un équipage par ID",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Détail de l’équipage"
          },
          "404": {
            "description": "Équipage non trouvé"
          }
        }
      },
      "put": {
        "tags": [
          "crews"
        ],
        "summary": "Modifier un équipage",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "event_id": {
                    "type": "string"
                  },
                  "category_id": {
                    "type": "string"
                  },
                  "status": {
                    "type": "string",
                    "enum": [
                      "registered",
                      "dns",
                      "dnf",
                      "disqualified",
                      "changed",
                      "withdrawn",
                      "scratch"
                    ],
                    "default": "registered",
                    "description": "Statut de l'équipage"
                  },
                  "club_name": {
                    "type": "string"
                  },
                  "club_code": {
                    "type": "string"
                  },
                  "coach_name": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Équipage mis à jour"
          }
        }
      },
      "delete": {
        "tags": [
          "crews"
        ],
        "summary": "Supprimer un équipage",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Équipage supprimé"
          }
        }
      }
    },
    "/crew-participants": {
      "post": {
        "tags": [
          "crewparticipants"
        ],
        "summary": "Ajouter un participant à un équipage",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "crew_id",
                  "participant_id"
                ],
                "properties": {
                  "crew_id": {
                    "type": "string"
                  },
                  "participant_id": {
                    "type": "string"
                  },
                  "is_coxswain": {
                    "type": "boolean"
                  },
                  "coxswain_weight": {
                    "type": "number"
                  },
                  "seat_position": {
                    "type": "integer"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Participant affecté"
          },
          "400": {
            "description": "Déjà affecté"
          }
        }
      }
    },
    "/crew-participants/{crew_id}": {
      "get": {
        "tags": [
          "crewparticipants"
        ],
        "summary": "Récupérer les participants d’un équipage",
        "parameters": [
          {
            "in": "path",
            "name": "crew_id",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Liste des membres de l’équipage"
          }
        }
      }
    },
    "/crew-participants/{id}": {
      "delete": {
        "tags": [
          "crewparticipants"
        ],
        "summary": "Retirer un participant d’un équipage",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Participant retiré"
          }
        }
      }
    },
    "/races": {
      "get": {
        "tags": [
          "races"
        ],
        "summary": "Liste des courses",
        "responses": {
          "200": {
            "description": "Liste renvoyée"
          }
        }
      },
      "post": {
        "tags": [
          "races"
        ],
        "summary": "Créer une course",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "phase_id"
                ],
                "properties": {
                  "phase_id": {
                    "type": "string"
                  },
                  "name": {
                    "type": "string"
                  },
                  "race_type": {
                    "type": "string"
                  },
                  "lane_count": {
                    "type": "integer",
                    "minimum": 1
                  },
                  "race_number": {
                    "type": "integer"
                  },
                  "distance_id": {
                    "type": "string"
                  },
                  "status": {
                    "type": "string",
                    "enum": [
                      "not_started",
                      "non_official",
                      "official",
                      "in_progress",
                      "delayed",
                      "cancelled",
                      "finished"
                    ]
                  },
                  "start_time": {
                    "type": "string",
                    "format": "date-time"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Course créée"
          }
        }
      }
    },
    "/races/event/{event_id}": {
      "get": {
        "tags": [
          "races"
        ],
        "summary": "Liste des courses d’un événement",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "event_id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID de l’événement"
          }
        ],
        "responses": {
          "200": {
            "description": "Liste des courses associées à l’événement"
          }
        }
      }
    },
    "/races/generate": {
      "post": {
        "tags": [
          "races"
        ],
        "summary": "Génère les courses et affecte les équipages",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "phase_id",
                  "lane_count"
                ],
                "properties": {
                  "phase_id": {
                    "type": "string",
                    "format": "uuid"
                  },
                  "lane_count": {
                    "type": "integer",
                    "minimum": 1
                  },
                  "start_time": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Heure de départ de la première course"
                  },
                  "interval_minutes": {
                    "type": "integer",
                    "minimum": 0,
                    "description": "Minutes entre chaque course"
                  },
                  "category_order": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "description": "Ordre personnalisé des catégories (tableau de codes de catégories).\nLes catégories seront traitées dans cet ordre lors de la génération des courses.\nLes catégories non listées seront ajoutées à la fin (triées par code).\nExemple: [\"H4X\", \"H2X\", \"F4X\", \"F2X\", \"H1X\", \"F1X\"]\n",
                    "example": [
                      "H4X",
                      "H2X",
                      "F4X",
                      "F2X"
                    ]
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Courses générées"
          }
        }
      }
    },
    "/races/generate-from-series": {
      "post": {
        "tags": [
          "races"
        ],
        "summary": "Génère les courses à partir de séries prédéfinies",
        "description": "Génère les courses en respectant la structure des séries fournie par le frontend.\nChaque série devient une course avec les équipages assignés selon le nombre spécifié par catégorie.\nLes équipages sont sélectionnés aléatoirement parmi ceux disponibles pour chaque catégorie.\n\n**Mode brouillon** : Utilisez `save_only: true` pour enregistrer uniquement le schéma sans générer les courses.\nVous pourrez ensuite générer les courses via `POST /race-phases/:id/generate-from-schema`.\n",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "phase_id",
                  "lane_count",
                  "series"
                ],
                "properties": {
                  "phase_id": {
                    "type": "string",
                    "format": "uuid"
                  },
                  "lane_count": {
                    "type": "integer",
                    "minimum": 1
                  },
                  "start_time": {
                    "type": "string",
                    "format": "date-time",
                    "description": "Heure de départ de la première course (optionnel)"
                  },
                  "interval_minutes": {
                    "type": "integer",
                    "minimum": 0,
                    "default": 5,
                    "description": "Minutes entre chaque course (optionnel)"
                  },
                  "series": {
                    "type": "array",
                    "minItems": 1,
                    "items": {
                      "type": "object",
                      "required": [
                        "id",
                        "categories"
                      ],
                      "properties": {
                        "id": {
                          "type": "string",
                          "description": "Identifiant unique de la série"
                        },
                        "categories": {
                          "type": "object",
                          "additionalProperties": {
                            "type": "integer",
                            "minimum": 1
                          },
                          "description": "Objet avec les codes de catégories comme clés et le nombre d'équipages comme valeurs.\nExemple: { \"SF\": 5, \"SH\": 1 } signifie 5 équipages \"Senior Femme\" et 1 \"Senior Homme\"\n"
                        }
                      }
                    },
                    "example": [
                      {
                        "id": "series-1234567890",
                        "categories": {
                          "SF": 5,
                          "SH": 1
                        }
                      },
                      {
                        "id": "series-1234567891",
                        "categories": {
                          "SF": 5,
                          "SH": 1
                        }
                      },
                      {
                        "id": "series-1234567892",
                        "categories": {
                          "JF": 6
                        }
                      }
                    ]
                  },
                  "save_only": {
                    "type": "boolean",
                    "default": false,
                    "description": "Si true, enregistre uniquement le schéma sans générer les courses (mode brouillon).\nVous pourrez ensuite générer les courses via POST /race-phases/:id/generate-from-schema.\n"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Courses générées avec succès",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "message": {
                      "type": "string",
                      "example": "5 courses générées avec succès"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "races_created": {
                          "type": "integer",
                          "description": "Nombre de courses créées"
                        },
                        "crews_assigned": {
                          "type": "integer",
                          "description": "Nombre total d'équipages assignés"
                        },
                        "races": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string"
                              },
                              "race_number": {
                                "type": "integer"
                              },
                              "start_time": {
                                "type": "string",
                                "format": "date-time"
                              },
                              "distance_id": {
                                "type": "string",
                                "nullable": true
                              },
                              "crews_count": {
                                "type": "integer"
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Erreurs de validation",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "error"
                    },
                    "message": {
                      "type": "string",
                      "example": "Erreurs de validation"
                    },
                    "errors": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      },
                      "example": [
                        "Série 1: Le nombre total de participants (7) dépasse le nombre de lignes d'eau (6)",
                        "Série 2: Les catégories ont des distances différentes"
                      ]
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/races/{id}": {
      "get": {
        "tags": [
          "races"
        ],
        "summary": "Obtenir une course par ID",
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "schema": {
              "type": "string"
            },
            "required": true
          }
        ],
        "responses": {
          "200": {
            "description": "Détail de la course"
          },
          "404": {
            "description": "Non trouvée"
          }
        }
      },
      "put": {
        "tags": [
          "races"
        ],
        "summary": "Modifier une course",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "schema": {
              "type": "string"
            },
            "required": true
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "phase_id": {
                    "type": "string"
                  },
                  "name": {
                    "type": "string"
                  },
                  "race_type": {
                    "type": "string"
                  },
                  "lane_count": {
                    "type": "integer",
                    "minimum": 1
                  },
                  "race_number": {
                    "type": "integer"
                  },
                  "distance_id": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Course mise à jour"
          }
        }
      },
      "delete": {
        "tags": [
          "races"
        ],
        "summary": "Supprimer une course",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "schema": {
              "type": "string"
            },
            "required": true
          }
        ],
        "responses": {
          "200": {
            "description": "Course supprimée"
          }
        }
      }
    },
    "/race-phases": {
      "post": {
        "tags": [
          "racephases"
        ],
        "summary": "Créer une phase de course",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "event_id",
                  "name",
                  "order_index"
                ],
                "properties": {
                  "event_id": {
                    "type": "string"
                  },
                  "name": {
                    "type": "string"
                  },
                  "order_index": {
                    "type": "integer"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Phase créée"
          }
        }
      }
    },
    "/race-phases/{event_id}": {
      "get": {
        "tags": [
          "racephases"
        ],
        "summary": "Récupérer les phases d’un événement",
        "parameters": [
          {
            "in": "path",
            "name": "event_id",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Liste des phases triée par ordre"
          }
        }
      }
    },
    "/race-phases/{id}": {
      "put": {
        "tags": [
          "racephases"
        ],
        "summary": "Modifier une phase",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string"
                  },
                  "order_index": {
                    "type": "integer"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Phase mise à jour"
          }
        }
      },
      "delete": {
        "tags": [
          "racephases"
        ],
        "summary": "Supprimer une phase",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Phase supprimée"
          }
        }
      }
    },
    "/race-phases/{id}/generate-from-schema": {
      "post": {
        "tags": [
          "racephases"
        ],
        "summary": "Générer les courses depuis le schéma enregistré",
        "description": "Génère les courses à partir du schéma de génération enregistré pour cette phase.\nLe schéma doit avoir été préalablement enregistré via POST /races/generate-from-series avec save_only=true\nou lors d'une génération précédente.\n",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "ID de la phase"
          }
        ],
        "responses": {
          "200": {
            "description": "Courses générées avec succès depuis le schéma enregistré",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "message": {
                      "type": "string",
                      "example": "3 courses générées avec succès depuis le schéma enregistré"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "races_created": {
                          "type": "integer"
                        },
                        "crews_assigned": {
                          "type": "integer"
                        },
                        "races": {
                          "type": "array",
                          "items": {
                            "type": "object"
                          }
                        },
                        "generation_schema": {
                          "type": "object"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Aucun schéma enregistré ou schéma invalide"
          },
          "404": {
            "description": "Phase introuvable"
          }
        }
      }
    },
    "/race-phases/{id}/generation-schema": {
      "get": {
        "tags": [
          "racephases"
        ],
        "summary": "Récupérer le schéma de génération des courses d'une phase",
        "description": "Récupère le schéma JSON utilisé pour générer les courses depuis les séries.\nCe schéma est automatiquement enregistré lors de l'appel à POST /races/generate-from-series.\n",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "ID de la phase"
          }
        ],
        "responses": {
          "200": {
            "description": "Schéma de génération récupéré avec succès",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "phase_id": {
                          "type": "string",
                          "format": "uuid"
                        },
                        "phase_name": {
                          "type": "string"
                        },
                        "generation_schema": {
                          "type": "object",
                          "nullable": true,
                          "properties": {
                            "lane_count": {
                              "type": "integer"
                            },
                            "start_time": {
                              "type": "string",
                              "format": "date-time",
                              "nullable": true
                            },
                            "interval_minutes": {
                              "type": "integer"
                            },
                            "series": {
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "id": {
                                    "type": "string"
                                  },
                                  "categories": {
                                    "type": "object",
                                    "additionalProperties": {
                                      "type": "integer"
                                    }
                                  }
                                }
                              }
                            },
                            "generated_at": {
                              "type": "string",
                              "format": "date-time"
                            },
                            "updated_at": {
                              "type": "string",
                              "format": "date-time"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Phase introuvable"
          }
        }
      },
      "put": {
        "tags": [
          "racephases"
        ],
        "summary": "Mettre à jour le schéma de génération des courses d'une phase",
        "description": "Met à jour le schéma JSON utilisé pour générer les courses depuis les séries.\nCe schéma peut être utilisé pour pré-remplir le formulaire de génération ou pour réappliquer la même configuration.\n",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "ID de la phase"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "generation_schema"
                ],
                "properties": {
                  "generation_schema": {
                    "type": "object",
                    "required": [
                      "lane_count",
                      "series"
                    ],
                    "properties": {
                      "lane_count": {
                        "type": "integer",
                        "minimum": 1,
                        "description": "Nombre de lignes d'eau disponibles"
                      },
                      "start_time": {
                        "type": "string",
                        "format": "date-time",
                        "nullable": true,
                        "description": "Heure de départ de la première course"
                      },
                      "interval_minutes": {
                        "type": "integer",
                        "minimum": 0,
                        "description": "Minutes entre chaque course"
                      },
                      "series": {
                        "type": "array",
                        "minItems": 1,
                        "items": {
                          "type": "object",
                          "required": [
                            "id",
                            "categories"
                          ],
                          "properties": {
                            "id": {
                              "type": "string",
                              "description": "Identifiant unique de la série"
                            },
                            "categories": {
                              "type": "object",
                              "additionalProperties": {
                                "type": "integer",
                                "minimum": 1
                              },
                              "description": "Objet avec codes de catégories comme clés et nombre d'équipages comme valeurs"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Schéma de génération mis à jour avec succès",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "message": {
                      "type": "string",
                      "example": "Schéma de génération mis à jour avec succès"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "phase_id": {
                          "type": "string",
                          "format": "uuid"
                        },
                        "phase_name": {
                          "type": "string"
                        },
                        "generation_schema": {
                          "type": "object"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Paramètres invalides"
          },
          "404": {
            "description": "Phase introuvable"
          }
        }
      }
    },
    "/race-crews": {
      "post": {
        "tags": [
          "racecrews"
        ],
        "summary": "Affecter un équipage à une course",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "race_id",
                  "crew_id"
                ],
                "properties": {
                  "race_id": {
                    "type": "string"
                  },
                  "crew_id": {
                    "type": "string"
                  },
                  "lane": {
                    "type": "integer",
                    "minimum": 1
                  },
                  "status": {
                    "type": "string",
                    "description": "DNS, DNF, DSQ ou vide"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Équipage affecté"
          },
          "400": {
            "description": "Déjà présent"
          }
        }
      }
    },
    "/race-crews/{race_id}": {
      "get": {
        "tags": [
          "racecrews"
        ],
        "summary": "Récupérer les équipages affectés à une course",
        "parameters": [
          {
            "in": "path",
            "name": "race_id",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Liste des équipages"
          }
        }
      }
    },
    "/race-crews/{id}": {
      "delete": {
        "tags": [
          "racecrews"
        ],
        "summary": "Retirer un équipage d’une course",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Supprimé"
          }
        }
      }
    },
    "/distances": {
      "get": {
        "tags": [
          "distances"
        ],
        "summary": "Liste des distances disponibles",
        "responses": {
          "200": {
            "description": "Liste renvoyée"
          }
        }
      },
      "post": {
        "tags": [
          "distances"
        ],
        "summary": "Créer une nouvelle distance",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "event_id"
                ],
                "properties": {
                  "event_id": {
                    "type": "string",
                    "example": "7c38e42f-198a-4bd6-9c59-9854094a1ea0"
                  },
                  "meters": {
                    "type": "integer",
                    "description": "Distance en mètres (requis si is_time_based = false).\nPour un relais: distance par segment (ex: 250 pour 8x250m).\nPour une course normale: distance totale (ex: 2000 pour 2000m).\n",
                    "minimum": 100,
                    "example": 2000
                  },
                  "is_relay": {
                    "type": "boolean",
                    "description": "Indique si c'est une course en relais",
                    "default": false,
                    "example": false
                  },
                  "relay_count": {
                    "type": "integer",
                    "description": "Nombre de relais (requis si is_relay = true). Ex: 8 pour 8x250m, 4 pour 4x500m",
                    "minimum": 2,
                    "maximum": 20,
                    "example": 8
                  },
                  "is_time_based": {
                    "type": "boolean",
                    "description": "Indique si la course est basée sur le temps plutôt que sur la distance",
                    "default": false,
                    "example": false
                  },
                  "duration_seconds": {
                    "type": "integer",
                    "description": "Durée en secondes (requis si is_time_based = true).\nEx: 120 pour 2 minutes, 300 pour 5 minutes, 60 pour 1 minute.\n",
                    "minimum": 1,
                    "example": 120
                  }
                },
                "allOf": [
                  {
                    "if": {
                      "properties": {
                        "is_time_based": {
                          "const": false
                        }
                      },
                      "then": {
                        "required": [
                          "meters"
                        ]
                      }
                    }
                  },
                  {
                    "if": {
                      "properties": {
                        "is_time_based": {
                          "const": true
                        }
                      },
                      "then": {
                        "required": [
                          "duration_seconds"
                        ]
                      }
                    }
                  }
                ]
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Distance créée"
          }
        }
      }
    },
    "/distances/event/{event_id}": {
      "get": {
        "tags": [
          "distances"
        ],
        "summary": "Liste des distances utilisées dans un événement",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "event_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Liste des distances"
          }
        }
      }
    },
    "/distances/{id}": {
      "delete": {
        "tags": [
          "distances"
        ],
        "summary": "Supprimer une distance",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Supprimée"
          }
        }
      }
    },
    "/timings": {
      "get": {
        "tags": [
          "timings"
        ],
        "summary": "Liste des chronométrages",
        "responses": {
          "200": {
            "description": "Liste des timings",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/Timing"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "timings"
        ],
        "summary": "Créer un timing",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "timing_point_id",
                  "timestamp"
                ],
                "properties": {
                  "timing_point_id": {
                    "type": "string"
                  },
                  "timestamp": {
                    "type": "string",
                    "format": "date-time"
                  },
                  "manual_entry": {
                    "type": "boolean"
                  },
                  "entered_by": {
                    "type": "string"
                  },
                  "status": {
                    "type": "string",
                    "enum": [
                      "pending",
                      "assigned",
                      "hidden"
                    ],
                    "default": "pending"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Timing enregistré",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "$ref": "#/components/schemas/Timing"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/timings/{id}": {
      "get": {
        "tags": [
          "timings"
        ],
        "summary": "Obtenir un timing par ID",
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "schema": {
              "type": "string"
            },
            "required": true,
            "description": "ID du timing"
          }
        ],
        "responses": {
          "200": {
            "description": "Détail du timing",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "$ref": "#/components/schemas/Timing"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Timing non trouvé"
          }
        }
      },
      "put": {
        "tags": [
          "timings"
        ],
        "summary": "Mettre à jour un timing",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "schema": {
              "type": "string"
            },
            "required": true,
            "description": "ID du timing à mettre à jour"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "timing_point_id": {
                    "type": "string"
                  },
                  "timestamp": {
                    "type": "string",
                    "format": "date-time"
                  },
                  "manual_entry": {
                    "type": "boolean"
                  },
                  "entered_by": {
                    "type": "string"
                  },
                  "status": {
                    "type": "string",
                    "enum": [
                      "pending",
                      "assigned",
                      "hidden"
                    ]
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Mise à jour réussie",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "$ref": "#/components/schemas/Timing"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Timing non trouvé"
          },
          "500": {
            "description": "Erreur serveur"
          }
        }
      },
      "delete": {
        "tags": [
          "timings"
        ],
        "summary": "Supprimer un timing",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "schema": {
              "type": "string"
            },
            "required": true,
            "description": "ID du timing à supprimer"
          }
        ],
        "responses": {
          "200": {
            "description": "Supprimé avec succès",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "message": {
                      "type": "string",
                      "example": "Timing supprimé"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Timing non trouvé"
          }
        }
      }
    },
    "/timings/event/{event_id}": {
      "get": {
        "tags": [
          "timings"
        ],
        "summary": "Liste des temps d’un événement donné",
        "parameters": [
          {
            "in": "path",
            "name": "event_id",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "ID de l’événement"
          }
        ],
        "responses": {
          "200": {
            "description": "Liste des temps pour l’événement",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/Timing"
                      }
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Événement non trouvé"
          }
        }
      }
    },
    "/timing-points": {
      "post": {
        "tags": [
          "timingpoints"
        ],
        "summary": "Créer un point de chronométrage",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "event_id",
                  "label",
                  "order_index",
                  "distance_m"
                ],
                "properties": {
                  "event_id": {
                    "type": "string"
                  },
                  "label": {
                    "type": "string",
                    "example": "Arrivée"
                  },
                  "order_index": {
                    "type": "integer",
                    "example": 3
                  },
                  "distance_m": {
                    "type": "integer",
                    "example": 5000
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Créé"
          }
        }
      }
    },
    "/timing-points/event/{event_id}": {
      "get": {
        "tags": [
          "timingpoints"
        ],
        "summary": "Récupérer les points d’une course",
        "parameters": [
          {
            "in": "path",
            "name": "event_id",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Liste des points"
          }
        }
      }
    },
    "/timing-points/{id}": {
      "put": {
        "tags": [
          "timingpoints"
        ],
        "summary": "Modifier un point de chronométrage",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "label": {
                    "type": "string"
                  },
                  "order_index": {
                    "type": "integer"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Mis à jour"
          }
        }
      },
      "delete": {
        "tags": [
          "timingpoints"
        ],
        "summary": "Supprimer un point de chronométrage",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Supprimé"
          }
        }
      }
    },
    "/timing-assignments": {
      "post": {
        "tags": [
          "timing-assignments"
        ],
        "summary": "Assigner un temps à un équipage",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "timing_id",
                  "crew_id"
                ],
                "properties": {
                  "timing_id": {
                    "type": "string"
                  },
                  "crew_id": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Assignation créée"
          }
        }
      }
    },
    "/timing-assignments/{id}": {
      "put": {
        "tags": [
          "timing-assignments"
        ],
        "summary": "Mettre à jour une assignation",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "timing_id",
                  "crew_id"
                ],
                "properties": {
                  "timing_id": {
                    "type": "string"
                  },
                  "crew_id": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Assignation mise à jour"
          }
        }
      },
      "delete": {
        "tags": [
          "timing-assignments"
        ],
        "summary": "Supprimer une assignation",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Assignation supprimée"
          }
        }
      }
    },
    "/timing-assignments/crew/{crew_id}": {
      "get": {
        "tags": [
          "timing-assignments"
        ],
        "summary": "Récupérer les assignations pour un équipage",
        "parameters": [
          {
            "in": "path",
            "name": "crew_id",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Liste des assignations"
          }
        }
      }
    },
    "/timing-assignments/event/{event_id}": {
      "get": {
        "tags": [
          "timing-assignments"
        ],
        "summary": "Récupérer toutes les assignations pour un événement",
        "parameters": [
          {
            "in": "path",
            "name": "event_id",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Liste complète avec détails"
          }
        }
      }
    },
    "/timing-assignments/race/{race_id}": {
      "get": {
        "tags": [
          "timing-assignments"
        ],
        "summary": "Récupérer toutes les assignations pour une course",
        "parameters": [
          {
            "in": "path",
            "name": "race_id",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Liste complète avec détails"
          }
        }
      }
    },
    "/users": {
      "get": {
        "tags": [
          "Users"
        ],
        "summary": "Liste des utilisateurs",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "query",
            "name": "search",
            "schema": {
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "role",
            "schema": {
              "type": "string",
              "enum": [
                "user",
                "admin",
                "superadmin"
              ]
            }
          },
          {
            "in": "query",
            "name": "page",
            "schema": {
              "type": "integer"
            }
          },
          {
            "in": "query",
            "name": "limit",
            "schema": {
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Utilisateurs récupérés",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserListResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "Users"
        ],
        "summary": "Créer un utilisateur (admin)",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "required": [
                  "name",
                  "email",
                  "num_license"
                ],
                "properties": {
                  "name": {
                    "type": "string"
                  },
                  "email": {
                    "type": "string"
                  },
                  "num_license": {
                    "type": "string"
                  },
                  "role": {
                    "type": "string",
                    "enum": [
                      "user",
                      "admin",
                      "superadmin"
                    ]
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Utilisateur créé",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserCreationResponse"
                }
              }
            }
          }
        }
      }
    },
    "/users/{identifier}": {
      "get": {
        "tags": [
          "Users"
        ],
        "summary": "Détail d’un utilisateur",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "identifier",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Email ou numéro de licence"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Détail utilisateur",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserDetailResponse"
                }
              }
            }
          }
        }
      }
    },
    "/users/{id}": {
      "patch": {
        "tags": [
          "Users"
        ],
        "summary": "Modifier un utilisateur",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "properties": {
                  "name": {
                    "type": "string"
                  },
                  "email": {
                    "type": "string"
                  },
                  "num_license": {
                    "type": "string"
                  },
                  "avatar": {
                    "type": "string"
                  },
                  "status": {
                    "type": "string",
                    "enum": [
                      "active",
                      "inactive"
                    ]
                  },
                  "role": {
                    "type": "string",
                    "enum": [
                      "user",
                      "admin",
                      "superadmin"
                    ]
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Utilisateur mis à jour"
          }
        }
      },
      "delete": {
        "tags": [
          "Users"
        ],
        "summary": "Désactiver un utilisateur",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Utilisateur désactivé"
          }
        }
      }
    },
    "/users/{id}/session-summary": {
      "get": {
        "tags": [
          "users"
        ],
        "summary": "Obtenir un résumé des sessions de l'utilisateur",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Résumé des sessions",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "totalSessions": {
                          "type": "integer"
                        },
                        "noShowSessions": {
                          "type": "integer"
                        },
                        "points": {
                          "type": "integer"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/users/{userId}/sessions": {
      "get": {
        "tags": [
          "users"
        ],
        "summary": "Lister les séances auxquelles un utilisateur est inscrit",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "userId",
            "in": "path",
            "required": true,
            "description": "ID de l'utilisateur",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Liste des séances inscrites",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/UserSession"
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Non autorisé"
          },
          "500": {
            "description": "Erreur serveur"
          }
        }
      }
    },
    "/users/me/session-summary": {
      "get": {
        "tags": [
          "users"
        ],
        "summary": "Obtenir un résumé des sessions pour l'utilisateur connecté",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Résumé des sessions de l'utilisateur connecté",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "totalSessions": {
                          "type": "integer",
                          "example": 12
                        },
                        "noShowSessions": {
                          "type": "integer",
                          "example": 3
                        },
                        "points": {
                          "type": "integer",
                          "example": -6
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/users/assign-club": {
      "post": {
        "tags": [
          "Users"
        ],
        "summary": "Associer un utilisateur à un club",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "required": [
                  "user_id",
                  "club_id"
                ],
                "properties": {
                  "user_id": {
                    "type": "string"
                  },
                  "club_id": {
                    "type": "string"
                  },
                  "role": {
                    "type": "string",
                    "enum": [
                      "member",
                      "coach",
                      "admin"
                    ]
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Utilisateur associé au club"
          }
        }
      }
    },
    "/import/manifestation/{id}": {
      "post": {
        "tags": [
          "Import"
        ],
        "summary": "Importer un événement avec ses épreuves, participants et bateaux",
        "description": "Crée un nouvel événement complet avec toutes les catégories, équipages et participants\ndepuis l'API FFAviron. Cette route crée un nouvel événement.\n",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID de la manifestation dans l'API source"
          }
        ],
        "responses": {
          "201": {
            "description": "Importation réussie",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "event_id": {
                          "type": "string"
                        },
                        "name": {
                          "type": "string"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/import/manifestation/{id}/update": {
      "post": {
        "tags": [
          "Import"
        ],
        "summary": "Mettre à jour un événement existant depuis l'API FFAviron",
        "description": "Met à jour un événement existant en ajoutant uniquement les nouveaux éléments\n(catégories, participants, équipages) sans toucher à l'existant.\nCette route ne supprime rien et ne duplique pas les données existantes.\nLes courses, phases et autres données déjà créées ne sont pas affectées.\n",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID de la manifestation dans l'API source"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "event_id"
                ],
                "properties": {
                  "event_id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "ID de l'événement à mettre à jour"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Événement mis à jour avec succès",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "message": {
                      "type": "string",
                      "example": "Événement mis à jour avec succès"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "event_id": {
                          "type": "string",
                          "format": "uuid"
                        },
                        "name": {
                          "type": "string"
                        },
                        "new_categories_count": {
                          "type": "integer",
                          "description": "Nombre de nouvelles catégories créées"
                        },
                        "new_crews_count": {
                          "type": "integer",
                          "description": "Nombre de nouveaux équipages créés"
                        },
                        "new_participants_count": {
                          "type": "integer",
                          "description": "Nombre de nouveaux participants créés"
                        },
                        "total_participants_count": {
                          "type": "integer",
                          "description": "Nombre total de participants liés aux nouveaux équipages"
                        },
                        "new_distances_count": {
                          "type": "integer",
                          "description": "Nombre de nouvelles distances créées"
                        },
                        "new_categories": {
                          "type": "array",
                          "description": "Détails complets des nouvelles catégories créées",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string",
                                "format": "uuid"
                              },
                              "code": {
                                "type": "string"
                              },
                              "label": {
                                "type": "string"
                              },
                              "age_group": {
                                "type": "string",
                                "nullable": true
                              },
                              "gender": {
                                "type": "string"
                              },
                              "boat_seats": {
                                "type": "integer",
                                "nullable": true
                              },
                              "has_coxswain": {
                                "type": "boolean"
                              },
                              "distance_id": {
                                "type": "string",
                                "format": "uuid",
                                "nullable": true
                              }
                            }
                          }
                        },
                        "new_distances": {
                          "type": "array",
                          "description": "Détails complets des nouvelles distances créées",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string",
                                "format": "uuid"
                              },
                              "meters": {
                                "type": "integer"
                              },
                              "is_relay": {
                                "type": "boolean"
                              },
                              "relay_count": {
                                "type": "integer",
                                "nullable": true
                              },
                              "label": {
                                "type": "string"
                              }
                            }
                          }
                        },
                        "new_crews": {
                          "type": "array",
                          "description": "Détails complets des nouveaux équipages créés",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string",
                                "format": "uuid"
                              },
                              "category_id": {
                                "type": "string",
                                "format": "uuid"
                              },
                              "category_code": {
                                "type": "string"
                              },
                              "category_label": {
                                "type": "string"
                              },
                              "club_name": {
                                "type": "string"
                              },
                              "club_code": {
                                "type": "string"
                              },
                              "status": {
                                "type": "integer"
                              }
                            }
                          }
                        },
                        "new_participants": {
                          "type": "array",
                          "description": "Détails complets des nouveaux participants créés",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string",
                                "format": "uuid"
                              },
                              "first_name": {
                                "type": "string"
                              },
                              "last_name": {
                                "type": "string"
                              },
                              "license_number": {
                                "type": "string",
                                "nullable": true
                              },
                              "gender": {
                                "type": "string"
                              },
                              "club_name": {
                                "type": "string"
                              },
                              "crew_id": {
                                "type": "string",
                                "format": "uuid"
                              },
                              "crew_club": {
                                "type": "string"
                              },
                              "is_coxswain": {
                                "type": "boolean"
                              },
                              "seat_position": {
                                "type": "integer",
                                "nullable": true
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Paramètres invalides (event_id manquant)"
          },
          "404": {
            "description": "Événement introuvable"
          },
          "500": {
            "description": "Erreur lors de la mise à jour"
          }
        }
      }
    },
    "/exports/startlist/phase/{phase_id}": {
      "get": {
        "tags": [
          "Exports"
        ],
        "summary": "Exporter la start list d'une phase au format PDF",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "phase_id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID de la phase"
          }
        ],
        "produces": [
          "application/pdf"
        ],
        "responses": {
          "200": {
            "description": "Fichier PDF de la start list",
            "content": {
              "application/pdf": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              }
            }
          },
          "404": {
            "description": "Phase non trouvée"
          }
        }
      }
    },
    "/exports/weighin/phase/{phase_id}": {
      "get": {
        "tags": [
          "Exports"
        ],
        "summary": "Exporter la liste de pesée d'une phase au format PDF",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "phase_id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID de la phase"
          }
        ],
        "produces": [
          "application/pdf"
        ],
        "responses": {
          "200": {
            "description": "Fichier PDF de la pesée",
            "content": {
              "application/pdf": {
                "schema": {
                  "type": "string",
                  "format": "binary"
                }
              }
            }
          },
          "404": {
            "description": "Phase non trouvée"
          }
        }
      }
    },
    "/user-events": {
      "post": {
        "tags": [
          "UserEvents"
        ],
        "summary": "Ajouter ou mettre à jour un accès utilisateur à un événement",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "email",
                  "event_id",
                  "role"
                ],
                "properties": {
                  "email": {
                    "type": "string",
                    "format": "email",
                    "description": "Adresse email de l'utilisateur (sera créé si n'existe pas)"
                  },
                  "event_id": {
                    "type": "string"
                  },
                  "role": {
                    "type": "string",
                    "enum": [
                      "viewer",
                      "editor",
                      "referee",
                      "timing",
                      "organiser"
                    ]
                  },
                  "name": {
                    "type": "string",
                    "description": "Nom de l'utilisateur (optionnel, extrait de l'email si non fourni)"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Lien utilisateur-événement enregistré",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "user_event": {
                          "type": "object",
                          "properties": {
                            "id": {
                              "type": "string"
                            },
                            "user_id": {
                              "type": "string"
                            },
                            "event_id": {
                              "type": "string"
                            },
                            "role": {
                              "type": "string"
                            }
                          }
                        },
                        "user": {
                          "type": "object",
                          "properties": {
                            "id": {
                              "type": "string"
                            },
                            "email": {
                              "type": "string"
                            },
                            "name": {
                              "type": "string"
                            }
                          }
                        },
                        "user_created": {
                          "type": "boolean",
                          "description": "Indique si l'utilisateur a été créé"
                        },
                        "temporary_password": {
                          "type": "string",
                          "nullable": true,
                          "description": "Mot de passe provisoire (uniquement si user_created = true)"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/user-events/{id}": {
      "delete": {
        "tags": [
          "UserEvents"
        ],
        "summary": "Supprimer un lien entre un utilisateur et un événement",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Supprimé avec succès"
          }
        }
      }
    },
    "/user-events/event/{event_id}": {
      "get": {
        "tags": [
          "UserEvents"
        ],
        "summary": "Lister tous les utilisateurs d’un événement",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "event_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Liste des utilisateurs avec rôles"
          }
        }
      }
    },
    "/server-time": {
      "get": {
        "tags": [
          "misc"
        ],
        "summary": "Heure actuelle du serveur",
        "description": "Renvoie l'heure actuelle du serveur (format ISO 8601)",
        "responses": {
          "200": {
            "description": "Heure du serveur",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "server_time": {
                      "type": "string",
                      "format": "date-time",
                      "example": "2025-06-29T12:00:00.000Z"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/server-time-offset": {
      "get": {
        "tags": [
          "misc"
        ],
        "summary": "Heure serveur avec calcul de décalage",
        "description": "Renvoie l'heure serveur + décalage par rapport à l'heure client.\nLe paramètre `client_time` doit être une date ISO valide.\n",
        "parameters": [
          {
            "in": "query",
            "name": "client_time",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time"
            },
            "description": "Heure actuelle du client"
          }
        ],
        "responses": {
          "200": {
            "description": "Heure serveur et décalage",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "server_time": {
                      "type": "string",
                      "format": "date-time",
                      "example": "2025-06-29T12:00:00.000Z"
                    },
                    "offset_ms": {
                      "type": "integer",
                      "example": -150,
                      "description": "Décalage entre client et serveur en millisecondes"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/rankings/event/{event_id}/ranking": {
      "get": {
        "tags": [
          "rankings"
        ],
        "summary": "Récupère le classement des clubs pour un événement",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "event_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "ranking_type",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "enum": [
                "indoor_points",
                "defis_capitaux",
                "custom"
              ],
              "default": "indoor_points"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Classement récupéré",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "event_id": {
                            "type": "string"
                          },
                          "club_name": {
                            "type": "string"
                          },
                          "club_code": {
                            "type": "string"
                          },
                          "total_points": {
                            "type": "number"
                          },
                          "rank": {
                            "type": "integer"
                          },
                          "ranking_type": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/rankings/event/{event_id}/club/{club_name}/points": {
      "get": {
        "tags": [
          "rankings"
        ],
        "summary": "Récupère les points détaillés d'un club",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "event_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "club_name",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "ranking_type",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "enum": [
                "indoor_points",
                "defis_capitaux",
                "custom"
              ],
              "default": "indoor_points"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Points détaillés récupérés"
          },
          "404": {
            "description": "Classement non trouvé"
          }
        }
      }
    },
    "/rankings/event/{event_id}/recalculate": {
      "post": {
        "tags": [
          "rankings"
        ],
        "summary": "Recalcule les rangs des clubs pour un événement",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "event_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "ranking_type": {
                    "type": "string",
                    "enum": [
                      "indoor_points",
                      "defis_capitaux",
                      "custom"
                    ],
                    "default": "indoor_points"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Rangs recalculés"
          }
        }
      }
    },
    "/rankings/race/{race_id}/calculate-points": {
      "post": {
        "tags": [
          "rankings"
        ],
        "summary": "Calcule et enregistre les points pour une course",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "race_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "ranking_type",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "enum": [
                "indoor_points",
                "defis_capitaux",
                "custom"
              ],
              "default": "indoor_points"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Points calculés et enregistrés",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "message": {
                          "type": "string"
                        },
                        "points": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "club_name": {
                                "type": "string"
                              },
                              "place": {
                                "type": "integer"
                              },
                              "points": {
                                "type": "number"
                              },
                              "points_type": {
                                "type": "string",
                                "enum": [
                                  "individuel",
                                  "relais"
                                ]
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/rankings/clubs/by-type/{event_type}": {
      "get": {
        "tags": [
          "rankings"
        ],
        "summary": "Récupère les classements des clubs groupés par événement pour un type d'événement",
        "description": "Récupère tous les événements d'un type donné (indoor, mer, rivière) et leurs classements de clubs.\nLes résultats sont groupés par événement, avec les classements des clubs pour chaque événement.\n",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "event_type",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Type d'événement (ex: \"indoor\", \"mer\", \"rivière\")",
            "example": "indoor"
          },
          {
            "name": "ranking_type",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "enum": [
                "indoor_points",
                "defis_capitaux",
                "custom"
              ],
              "default": "indoor_points"
            },
            "description": "Type de classement à utiliser"
          }
        ],
        "responses": {
          "200": {
            "description": "Classements récupérés avec succès",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "event": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string",
                                "format": "uuid"
                              },
                              "name": {
                                "type": "string"
                              },
                              "location": {
                                "type": "string"
                              },
                              "start_date": {
                                "type": "string",
                                "format": "date-time"
                              },
                              "end_date": {
                                "type": "string",
                                "format": "date-time"
                              },
                              "race_type": {
                                "type": "string"
                              }
                            }
                          },
                          "rankings": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "id": {
                                  "type": "string",
                                  "format": "uuid"
                                },
                                "club_name": {
                                  "type": "string"
                                },
                                "club_code": {
                                  "type": "string",
                                  "nullable": true
                                },
                                "total_points": {
                                  "type": "number"
                                },
                                "rank": {
                                  "type": "integer",
                                  "nullable": true
                                },
                                "points_count": {
                                  "type": "integer",
                                  "description": "Nombre de points détaillés attribués"
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                },
                "example": {
                  "status": "success",
                  "data": [
                    {
                      "event": {
                        "id": "event-uuid-1",
                        "name": "Championnat Indoor 2025",
                        "location": "Paris",
                        "start_date": "2025-01-15T00:00:00.000Z",
                        "end_date": "2025-01-16T00:00:00.000Z",
                        "race_type": "indoor"
                      },
                      "rankings": [
                        {
                          "id": "ranking-uuid-1",
                          "club_name": "Club Aviron Paris",
                          "club_code": "PAR",
                          "total_points": 150.5,
                          "rank": 1,
                          "points_count": 12
                        },
                        {
                          "id": "ranking-uuid-2",
                          "club_name": "Club Aviron Lyon",
                          "club_code": "LYO",
                          "total_points": 120,
                          "rank": 2,
                          "points_count": 10
                        }
                      ]
                    }
                  ]
                }
              }
            }
          },
          "500": {
            "description": "Erreur serveur"
          }
        }
      }
    },
    "/rankings/templates": {
      "get": {
        "tags": [
          "rankings"
        ],
        "summary": "Liste des templates de points",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "type",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "enum": [
                "indoor_points",
                "defis_capitaux",
                "custom"
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Liste des templates"
          }
        }
      },
      "post": {
        "tags": [
          "rankings"
        ],
        "summary": "Crée un template de points",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "name",
                  "type",
                  "config"
                ],
                "properties": {
                  "name": {
                    "type": "string"
                  },
                  "type": {
                    "type": "string",
                    "enum": [
                      "indoor_points",
                      "defis_capitaux",
                      "custom"
                    ]
                  },
                  "config": {
                    "type": "object",
                    "description": "Configuration JSON des points"
                  },
                  "is_default": {
                    "type": "boolean",
                    "default": false
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Template créé"
          }
        }
      }
    },
    "/notifications": {
      "get": {
        "tags": [
          "notifications"
        ],
        "summary": "Liste toutes les notifications (backoffice)",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "query",
            "name": "event_id",
            "schema": {
              "type": "string"
            },
            "description": "Filtrer par événement"
          },
          {
            "in": "query",
            "name": "race_id",
            "schema": {
              "type": "string"
            },
            "description": "Filtrer par course"
          },
          {
            "in": "query",
            "name": "is_active",
            "schema": {
              "type": "boolean"
            },
            "description": "Filtrer par statut actif"
          }
        ],
        "responses": {
          "200": {
            "description": "Liste des notifications",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/Notification"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "notifications"
        ],
        "summary": "Créer une nouvelle notification",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "message"
                ],
                "properties": {
                  "event_id": {
                    "type": "string",
                    "description": "ID de l'événement (requis si race_id n'est pas fourni)"
                  },
                  "race_id": {
                    "type": "string",
                    "description": "ID de la course (requis si event_id n'est pas fourni)"
                  },
                  "message": {
                    "type": "string",
                    "minLength": 1,
                    "maxLength": 1000,
                    "description": "Message de la notification"
                  },
                  "importance": {
                    "type": "string",
                    "enum": [
                      "info",
                      "warning",
                      "error",
                      "success"
                    ],
                    "default": "info",
                    "description": "Niveau d'importance"
                  },
                  "is_active": {
                    "type": "boolean",
                    "default": true,
                    "description": "Si la notification est active"
                  },
                  "start_date": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "Date de début d'affichage (null = immédiat)"
                  },
                  "end_date": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true,
                    "description": "Date de fin d'affichage (null = pas d'expiration)"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Notification créée",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string"
                    },
                    "data": {
                      "$ref": "#/components/schemas/Notification"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/notifications/event/{event_id}": {
      "get": {
        "tags": [
          "notifications"
        ],
        "summary": "Récupérer les notifications actives d'un événement",
        "parameters": [
          {
            "in": "path",
            "name": "event_id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID de l'événement"
          }
        ],
        "responses": {
          "200": {
            "description": "Liste des notifications actives",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/Notification"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/notifications/race/{race_id}": {
      "get": {
        "tags": [
          "notifications"
        ],
        "summary": "Récupérer les notifications actives d'une course",
        "description": "Retourne les notifications spécifiques à la course ET les notifications de l'événement parent\n",
        "parameters": [
          {
            "in": "path",
            "name": "race_id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID de la course"
          }
        ],
        "responses": {
          "200": {
            "description": "Liste des notifications actives",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/Notification"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/notifications/{id}": {
      "put": {
        "tags": [
          "notifications"
        ],
        "summary": "Mettre à jour une notification",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID de la notification"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "message": {
                    "type": "string",
                    "minLength": 1,
                    "maxLength": 1000
                  },
                  "importance": {
                    "type": "string",
                    "enum": [
                      "info",
                      "warning",
                      "error",
                      "success"
                    ]
                  },
                  "is_active": {
                    "type": "boolean"
                  },
                  "start_date": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true
                  },
                  "end_date": {
                    "type": "string",
                    "format": "date-time",
                    "nullable": true
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Notification mise à jour",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string"
                    },
                    "data": {
                      "$ref": "#/components/schemas/Notification"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "notifications"
        ],
        "summary": "Supprimer une notification",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "ID de la notification"
          }
        ],
        "responses": {
          "200": {
            "description": "Notification supprimée",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string"
                    },
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/clubs": {
      "get": {
        "tags": [
          "clubs"
        ],
        "summary": "Récupérer la liste des clubs",
        "description": "Récupère la liste des clubs depuis l'API FFA (Fédération Française d'Aviron).\nFiltre uniquement les structures de type \"CLU\" (clubs).\n",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Liste des clubs",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/Club"
                      }
                    },
                    "count": {
                      "type": "integer",
                      "description": "Nombre de clubs retournés",
                      "example": 150
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Erreur lors de la récupération",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "error"
                    },
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/indoor-results/import": {
      "post": {
        "tags": [
          "indoor-results"
        ],
        "summary": "Importer les résultats d'une course depuis ErgRace",
        "description": "Importe les résultats d'une course depuis le format JSON ErgRace.\nLes résultats sont automatiquement liés aux équipages (crews) si l'ID ErgRace correspond à un crew_id.\nLe JSON complet est conservé dans `raw_data` pour traçabilité.\n\n**Filtrage automatique** : Les lanes vides (sans résultats) sont automatiquement ignorées :\n- Participants avec `participant: \"EMPTY\"` ou `class: \"EMPTY\"`\n- Lanes avec ID au format \"Lane X\" sans temps ou distance valide\n",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "results"
                ],
                "properties": {
                  "results": {
                    "type": "object",
                    "required": [
                      "race_id"
                    ],
                    "properties": {
                      "race_id": {
                        "type": "string",
                        "format": "uuid",
                        "description": "ID de la course dans ErgRace (UUID)",
                        "example": "46916f84-f780-488c-813d-a5475142f86e"
                      },
                      "c2_race_id": {
                        "type": "string",
                        "format": "uuid",
                        "description": "ID de la course dans notre plateforme (optionnel)",
                        "example": "abc-123-def-456"
                      },
                      "ergrace_version": {
                        "type": "string",
                        "example": "03.01.01"
                      },
                      "race_start_time": {
                        "type": "string",
                        "format": "date-time",
                        "example": "2025-11-28 18:33:05"
                      },
                      "race_end_time": {
                        "type": "string",
                        "format": "date-time",
                        "example": "2025-11-28 18:33:44"
                      },
                      "duration": {
                        "type": "integer",
                        "description": "Durée en millisecondes",
                        "example": 100
                      },
                      "time_cap": {
                        "type": "integer",
                        "example": 0
                      },
                      "race_file_name": {
                        "type": "string",
                        "example": "Course_test_46916f84-f780-488c-813d-a5475142f86e.rac2"
                      },
                      "participants": {
                        "type": "array",
                        "items": {
                          "type": "object",
                          "properties": {
                            "id": {
                              "type": "string",
                              "description": "ID du participant (UUID du crew_id ou \"Lane X\")",
                              "example": "c45d85a1-8493-4e3e-9440-1a7ef4852406"
                            },
                            "place": {
                              "type": "integer",
                              "example": 1
                            },
                            "time": {
                              "type": "string",
                              "example": "0:24.1"
                            },
                            "score": {
                              "type": "string",
                              "example": "0:24.1"
                            },
                            "distance": {
                              "type": "integer",
                              "example": 100
                            },
                            "avg_pace": {
                              "type": "string",
                              "example": "2:00.5"
                            },
                            "spm": {
                              "type": "integer",
                              "description": "Strokes per minute",
                              "example": 32
                            },
                            "calories": {
                              "type": "integer",
                              "example": 6
                            },
                            "serial_number": {
                              "type": "integer",
                              "example": 431859705
                            },
                            "machine_type": {
                              "type": "string",
                              "example": "row"
                            },
                            "logged_time": {
                              "type": "string",
                              "example": "28/11/2025 18:32:00"
                            },
                            "splits": {
                              "type": "array",
                              "description": "Splits détaillés (optionnel)"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Résultats mis à jour avec succès"
          },
          "201": {
            "description": "Résultats importés avec succès",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "message": {
                      "type": "string",
                      "example": "Résultats importés avec succès"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "indoor_race_result_id": {
                          "type": "string",
                          "format": "uuid"
                        },
                        "race_id": {
                          "type": "string",
                          "format": "uuid",
                          "nullable": true
                        },
                        "ergrace_race_id": {
                          "type": "string",
                          "format": "uuid"
                        },
                        "participants_count": {
                          "type": "integer"
                        },
                        "linked_crews_count": {
                          "type": "integer",
                          "description": "Nombre d'équipages liés automatiquement"
                        },
                        "unlinked_participants_count": {
                          "type": "integer",
                          "description": "Nombre de participants non liés (ex: \"Lane X\")"
                        },
                        "skipped_empty_lanes": {
                          "type": "integer",
                          "description": "Nombre de lanes vides ignorées lors de l'import"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Format JSON invalide"
          },
          "404": {
            "description": "Course introuvable (si c2_race_id fourni)"
          }
        }
      }
    },
    "/indoor-results/race/{race_id}": {
      "get": {
        "tags": [
          "indoor-results"
        ],
        "summary": "Récupérer les résultats d'une course",
        "description": "Récupère les résultats d'une course indoor avec les détails des participants,\nincluant les informations des équipages (club, catégorie) si liés.\n\n**Accès public** : Cet endpoint est accessible publiquement (sans authentification) \nsi la course a le statut \"non_official\" ou \"official\". Pour les autres statuts, \nl'authentification est requise.\n\n**Données sensibles** : Le champ `raw_data` n'est retourné que si l'utilisateur est authentifié.\nLe champ `splits_data` est toujours retourné (utile pour l'affichage des splits).\n",
        "security": [],
        "parameters": [
          {
            "in": "path",
            "name": "race_id",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "ID de la course dans la plateforme"
          }
        ],
        "responses": {
          "200": {
            "description": "Résultats récupérés avec succès",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "race_result": {
                          "type": "object",
                          "properties": {
                            "id": {
                              "type": "string",
                              "format": "uuid"
                            },
                            "race_id": {
                              "type": "string",
                              "format": "uuid"
                            },
                            "ergrace_race_id": {
                              "type": "string",
                              "format": "uuid"
                            },
                            "race_start_time": {
                              "type": "string",
                              "format": "date-time"
                            },
                            "race_end_time": {
                              "type": "string",
                              "format": "date-time"
                            },
                            "duration": {
                              "type": "integer"
                            }
                          }
                        },
                        "participants": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string",
                                "format": "uuid"
                              },
                              "place": {
                                "type": "integer"
                              },
                              "time_display": {
                                "type": "string"
                              },
                              "time_ms": {
                                "type": "integer"
                              },
                              "score": {
                                "type": "string"
                              },
                              "distance": {
                                "type": "integer"
                              },
                              "avg_pace": {
                                "type": "string"
                              },
                              "spm": {
                                "type": "integer"
                              },
                              "calories": {
                                "type": "integer"
                              },
                              "machine_type": {
                                "type": "string"
                              },
                              "logged_time": {
                                "type": "string",
                                "format": "date-time"
                              },
                              "crew": {
                                "type": "object",
                                "nullable": true,
                                "properties": {
                                  "id": {
                                    "type": "string",
                                    "format": "uuid"
                                  },
                                  "club_name": {
                                    "type": "string"
                                  },
                                  "club_code": {
                                    "type": "string"
                                  },
                                  "category": {
                                    "type": "object",
                                    "nullable": true,
                                    "properties": {
                                      "id": {
                                        "type": "string",
                                        "format": "uuid"
                                      },
                                      "code": {
                                        "type": "string"
                                      },
                                      "label": {
                                        "type": "string"
                                      }
                                    }
                                  }
                                }
                              },
                              "ergrace_participant_id": {
                                "type": "string"
                              },
                              "splits_data": {
                                "type": "object",
                                "nullable": true
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Authentification requise (si la course n'est pas publique)"
          },
          "404": {
            "description": "Aucun résultat trouvé pour cette course"
          }
        }
      }
    },
    "/indoor-results/event/{event_id}": {
      "get": {
        "tags": [
          "indoor-results"
        ],
        "summary": "Récupérer tous les résultats d'un événement",
        "description": "Récupère tous les résultats des courses indoor d'un événement.\n",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "event_id",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "ID de l'événement"
          }
        ],
        "responses": {
          "200": {
            "description": "Liste des résultats récupérée avec succès",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "race": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string",
                                "format": "uuid"
                              },
                              "name": {
                                "type": "string"
                              },
                              "race_number": {
                                "type": "integer"
                              }
                            }
                          },
                          "result": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string",
                                "format": "uuid"
                              },
                              "race_start_time": {
                                "type": "string",
                                "format": "date-time"
                              },
                              "race_end_time": {
                                "type": "string",
                                "format": "date-time"
                              },
                              "duration": {
                                "type": "integer"
                              }
                            }
                          },
                          "participants": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "place": {
                                  "type": "integer"
                                },
                                "time_display": {
                                  "type": "string"
                                },
                                "crew": {
                                  "type": "object",
                                  "nullable": true,
                                  "properties": {
                                    "club_name": {
                                      "type": "string"
                                    },
                                    "category": {
                                      "type": "string"
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/indoor-results/event/{event_id}/bycategorie": {
      "get": {
        "tags": [
          "indoor-results"
        ],
        "summary": "Récupérer tous les résultats d'un événement classé par catégorie",
        "description": "Récupère tous les résultats des courses indoor d'un événement, groupés et triés par catégorie.\nInclut les informations détaillées sur les équipages (code club et participants).\n",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "in": "path",
            "name": "event_id",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "description": "ID de l'événement"
          }
        ],
        "responses": {
          "200": {
            "description": "Résultats groupés par catégorie récupérés avec succès",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "category": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string",
                                "format": "uuid"
                              },
                              "code": {
                                "type": "string",
                                "nullable": true
                              },
                              "label": {
                                "type": "string",
                                "nullable": true
                              },
                              "age_group": {
                                "type": "string",
                                "nullable": true
                              },
                              "gender": {
                                "type": "string",
                                "nullable": true,
                                "enum": [
                                  "Homme",
                                  "Femme",
                                  "Mixte"
                                ]
                              }
                            }
                          },
                          "results": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "race_id": {
                                  "type": "string",
                                  "format": "uuid"
                                },
                                "race_number": {
                                  "type": "integer"
                                },
                                "race_name": {
                                  "type": "string",
                                  "nullable": true
                                },
                                "place_in_race": {
                                  "type": "integer",
                                  "nullable": true,
                                  "description": "Place dans la course/série (conservée pour référence)"
                                },
                                "position": {
                                  "type": "integer",
                                  "nullable": true,
                                  "description": "Position dans le classement de la catégorie (1, 2, 3, ... calculée après tri par temps)"
                                },
                                "points": {
                                  "type": "number",
                                  "nullable": true,
                                  "description": "Points attribués selon le classement de la catégorie (basé sur le template \"Points Indoor\"). Null si non éligible (temps 0, distance non éligible, catégorie exclue, etc.)"
                                },
                                "is_eligible_for_points": {
                                  "type": "boolean",
                                  "description": "Indique si le résultat est éligible pour les points (distance 2000m, 500m ou relais 8x250, temps non nul, et catégorie non exclue). Les catégories avec codes U15, U14, U13, U12, U11, U10, J15, J14, J13, J12, J11, J10 sont exclues."
                                },
                                "time_display": {
                                  "type": "string",
                                  "nullable": true
                                },
                                "time_ms": {
                                  "type": "integer",
                                  "nullable": true
                                },
                                "score": {
                                  "type": "integer",
                                  "nullable": true
                                },
                                "distance": {
                                  "type": "integer",
                                  "nullable": true
                                },
                                "distance_info": {
                                  "type": "object",
                                  "nullable": true,
                                  "description": "Informations sur la distance de la course",
                                  "properties": {
                                    "id": {
                                      "type": "string",
                                      "format": "uuid"
                                    },
                                    "meters": {
                                      "type": "integer",
                                      "nullable": true
                                    },
                                    "is_relay": {
                                      "type": "boolean"
                                    },
                                    "relay_count": {
                                      "type": "integer",
                                      "nullable": true
                                    },
                                    "label": {
                                      "type": "string",
                                      "description": "Label formaté de la distance (ex: \"2000m\", \"8x250m\")"
                                    }
                                  }
                                },
                                "avg_pace": {
                                  "type": "string",
                                  "nullable": true
                                },
                                "spm": {
                                  "type": "integer",
                                  "nullable": true
                                },
                                "calories": {
                                  "type": "integer",
                                  "nullable": true
                                },
                                "machine_type": {
                                  "type": "string",
                                  "nullable": true
                                },
                                "logged_time": {
                                  "type": "string",
                                  "format": "date-time",
                                  "nullable": true
                                },
                                "crew_id": {
                                  "type": "string",
                                  "format": "uuid",
                                  "nullable": true
                                },
                                "crew": {
                                  "type": "object",
                                  "nullable": true,
                                  "properties": {
                                    "id": {
                                      "type": "string",
                                      "format": "uuid"
                                    },
                                    "club_name": {
                                      "type": "string",
                                      "nullable": true
                                    },
                                    "club_code": {
                                      "type": "string",
                                      "nullable": true
                                    },
                                    "category": {
                                      "type": "object",
                                      "nullable": true,
                                      "properties": {
                                        "id": {
                                          "type": "string",
                                          "format": "uuid"
                                        },
                                        "code": {
                                          "type": "string"
                                        },
                                        "label": {
                                          "type": "string"
                                        },
                                        "age_group": {
                                          "type": "string",
                                          "nullable": true
                                        },
                                        "gender": {
                                          "type": "string",
                                          "nullable": true
                                        }
                                      }
                                    },
                                    "participants": {
                                      "type": "array",
                                      "items": {
                                        "type": "object",
                                        "properties": {
                                          "id": {
                                            "type": "string",
                                            "format": "uuid",
                                            "nullable": true
                                          },
                                          "first_name": {
                                            "type": "string",
                                            "nullable": true
                                          },
                                          "last_name": {
                                            "type": "string",
                                            "nullable": true
                                          },
                                          "license_number": {
                                            "type": "string",
                                            "nullable": true
                                          },
                                          "seat_position": {
                                            "type": "integer",
                                            "nullable": true
                                          },
                                          "is_coxswain": {
                                            "type": "boolean"
                                          }
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Événement non trouvé"
          },
          "500": {
            "description": "Erreur serveur"
          }
        }
      }
    }
  },
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    },
    "schemas": {
      "Club": {
        "type": "object",
        "description": "Informations d'un club",
        "properties": {
          "nom": {
            "type": "string",
            "description": "Nom complet du club",
            "example": "CLUB AVIRON MARSEILLE"
          },
          "nom_court": {
            "type": "string",
            "description": "Nom court du club",
            "example": "CAM"
          },
          "code": {
            "type": "string",
            "description": "Code unique du club",
            "example": "C130001"
          },
          "etat": {
            "type": "string",
            "description": "État du club (A = Actif, I = Inactif)",
            "example": "A"
          },
          "type": {
            "type": "string",
            "description": "Type de structure (toujours \"CLU\" pour les clubs)",
            "example": "CLU"
          },
          "logo": {
            "type": "string",
            "nullable": true,
            "description": "Chemin relatif du logo",
            "example": "a7/bc/a7bc4c71-2711-402c-848f-b773d353d187.png"
          },
          "logo_url": {
            "type": "string",
            "nullable": true,
            "description": "URL complète du logo",
            "example": "https://intranet.ffaviron.fr/storage/logos_structures/a7/bc/a7bc4c71-2711-402c-848f-b773d353d187.png"
          },
          "code_region": {
            "type": "string",
            "nullable": true,
            "description": "Code de la région",
            "example": "LR13"
          },
          "nom_region": {
            "type": "string",
            "nullable": true,
            "description": "Nom de la région",
            "example": "LIGUE AVIRON SUD PROVENCE-ALPES-COTE D'AZUR"
          },
          "code_departement": {
            "type": "string",
            "nullable": true,
            "description": "Code du département",
            "example": "CD013"
          },
          "nom_departement": {
            "type": "string",
            "nullable": true,
            "description": "Nom du département",
            "example": "COMITÉ DÉPARTEMENTAL DES BOUCHES DU RHÔNE"
          }
        }
      }
    }
  },
  "tags": [
    {
      "name": "auth",
      "description": "Gestion de l'authentification et des utilisateurs"
    },
    {
      "name": "Events",
      "description": "Gestion des événements (courses, compétitions)"
    },
    {
      "name": "participants",
      "description": "Gestion des rameurs/rameuses et leurs informations"
    },
    {
      "name": "categories",
      "description": "Gestion des catégories (âge, sexe, type de bateau...)"
    },
    {
      "name": "eventcategories",
      "description": "Liaison entre événements et catégories"
    },
    {
      "name": "crews",
      "description": "Gestion des équipages/bateaux associés à un événement et une catégorie"
    },
    {
      "name": "crewparticipants",
      "description": "Affectation des participants à un équipage"
    },
    {
      "name": "races",
      "description": "Gestion des courses (configuration, phases, distances...)"
    },
    {
      "name": "racephases",
      "description": "Gestion des phases d’une compétition (Séries, Demi-finales, Finales, etc.)"
    },
    {
      "name": "racecrews",
      "description": "Affectation des équipages à une course, ligne d'eau et statut (DNS, DSQ…)"
    },
    {
      "name": "distances",
      "description": "Gestion des distances utilisées pour les courses"
    },
    {
      "name": "timings",
      "description": "Gestion des enregistrements de chronométrage"
    },
    {
      "name": "timingpoints",
      "description": "Points de chronométrage dans une course (Départ, Intermédiaire, Arrivée)"
    },
    {
      "name": "timing-assignments",
      "description": "Assignation des temps aux équipages"
    },
    {
      "name": "Import",
      "description": "Importer une manifestation complète depuis l'API fédérale"
    },
    {
      "name": "Exports",
      "description": "Génération et téléchargement de documents PDF (start list, pesée, etc.)"
    },
    {
      "name": "UserEvents",
      "description": "Gestion des utilisateurs liés à un événement"
    },
    {
      "name": "misc",
      "description": "Routes utilitaires diverses"
    },
    {
      "name": "rankings",
      "description": "Gestion des classements des clubs"
    },
    {
      "name": "notifications",
      "description": "Gestion des notifications pour les événements et les courses"
    },
    {
      "name": "clubs",
      "description": "Gestion des clubs (récupération depuis l'API FFA)"
    },
    {
      "name": "indoor-results",
      "description": "Gestion des résultats des courses indoor (ErgRace)"
    }
  ],
  "security": []
}